# Databricks notebook source
##################################################################################
# Model Serving Endpoint Notebook
#
# This notebook shows an example of provisioning a model serving endpoint.
# It is configured and can be executed as the tasks in the write_feature_table_job workflow defined under
# ``{{template `project_name_alphanumeric_underscore` .}}/resources/model-serving-endpoint-workflow-resource.yml``
#
# Parameters:
# * endpoint_name (required)                    - Name of the Model Serving Endpoint 
#  
##################################################################################

# COMMAND ----------

# List of input args needed to run this notebook as a job.
# Provide them via DB widgets or notebook arguments.
#
# A model serving model endpoint
dbutils.widgets.text(
    "endpoint_name",
    "",
    label="Name of model serving endpoint",
)

# COMMAND ----------

import os
notebook_path =  '/Workspace/' + os.path.dirname(dbutils.notebook.entry_point.getDbutils().notebook().getContext().notebookPath().get())
%cd $notebook_path
%cd ../deployment

# COMMAND ----------

# DBTITLE 1,Define input and output variables
endpoint_name = dbutils.widgets.get("endpoint_name")

assert endpoint_name != "", "endpoint_name notebook parameter must be specified"

# COMMAND ----------

# Provision model serving endpoint
from provision_endpoint import wait_for_model_serving_endpoint_to_be_ready

wait_for_model_serving_endpoint_to_be_ready(endpoint_name)

# COMMAND ----------

dbutils.notebook.exit(0)